
/*
	language stuff !!

	prettty janky,
	like REALLY janky
*/

var languages = { // since i couldnt figure out how to load external jsons :(
	"english": { // kind of a template for stuff ???
		"index": {
			"mainWindow": {
				"title": "main page",
				"content": [
					"hey! welcom 2 my website!!",
					'sonic going like "hii person :D"',
					"here, in this corner of da internet",
					"you're able to find stuff i do, and stuff i write",
					"i'm still workin' on it though (sometimes) :P",
					"make sure to check out the other pages though!!",
					"if u want to do so, atleast",
					"MOBILE DEVICES BEWARE!!",
					"the website could end up biting you D:",
					"atleast so i've been told!",
					'oh yeah, here\'s my <a href="https://pacola.atabook.org/" target="_blank" rel="noopener noreferrer">guestbook</a>!!'
				]
			},

			"statuscafe": {
				"title": "status cafe thingie"
			},

			"characterWindow": {
				"title": "my character",
				"content": [
					"insert char here :)"
				]
			},

			"pacThing": {
				"title": "pac thing of the time",
				"content": [
					"sonic blast's a cool",
          "game, in my opinion"
				]
			}
		},

		"aboutme": {
			"mainWindow": {
				"title": "about me :D",
				"content": [
					"i'm pacola, but u can call me just pac too!",
          "i go by she/her (transfem!), i like sonic, programming, i think",
          "idk much to say about me, really",
          "what do i do with my life?",
          "nothing!! ...that's really useful",
          "other than that, i've:",
          "... did i mention i like sonic???"
				]
			},
			"aboutmeList": {
				"content": [
					"made some stupid lil' ass srb2 mods, ya can find some of 'em in the projects page!",
					'got 2 WRs in <a href="https://www.speedrun.com/sonicblast" target="_blank" rel="noopener noreferrer">Sonic Blast</a> (both sonic categories!), which i\'m really proud of :D',
					"some art, nothing fancy",
					"some code, sometimes, never said it was good",
					"procastinated a lot"
				]
			}
		},

		"projects": { // this one's pure jank, ngl
			"glassMain2TheSequel": {
				"title": "da (srb2) projects",
				"content": [
					'some other mods can be found at my <a href="https://github.com/PacolaYes" target="_blank" rel="noopener noreferrer">github</a> too, though they may be either abandoned or just unfinished :P'
				]
			},

			"blastHUDIMG": {
				"content": [
					"gif showcasing Sonic Blast's title card in SRB2"
				]
			},
			"blastHUDContent": {
				"content": [
					"<h2>Sonic Blast HUD</h2>",
					"A simple looking mod, replaces SRB2's in-game hud with the one seen in Sonic Blast."
				]
			},

			"sunkyIMG": {
				"content": [
					"gif showcasing Sunky falling off an edge in Greenflower Zone act 1"
				]
			},
			"sunkyContent": {
				"content": [
					"<h2>Sunky</h2>",
					"adds Sunky, current version is supposed to be as accurate as i could to Sunky the Game, may get an update one day, or so i hope!"
				]
			},

			"smwLuigiIMG": {
				"content": [
					"gif showcasing SMW Luigi spin-jumping, running and sliding"
				]
			},
			"smwLuigiContent": {
				"content": [
					"<h2>SMW Luigi</h2>",
					"aims to add Luigi and some other stuff from Super Mario World.",
          "Still being made, sometimes. But you can get some builds, sometimes too."
				]
			}
		},

		"blog-home": {
			"mainWindow": {
				"title": "blogs!!",
				"content": [
					"here's where i do the \"blog\" stuff",
          "not sure if it's actually a blog, i'd call it something like:",
          '"place where i may or may not sometimes write something but most of the time its probably gonna be a may not since im probably not gonna write it but it may happen maybe"',
          "not sure what else to write here, check the right thing for the blogs",
          "if there's any :P"
				]
			},
			"blogList": {
				"title": "listed blogs"
			}
		},

		"global": {
			"thelinknames": [
				"home!",
				"about me!",
				"my projects",
				"blog thingie"
			]
		}
	},

	"portuguese": {
		"index": {
			"mainWindow": {
				"title": "página principal",
				"content": [
					"opa! bem-vindo ao meu site!!",
					'sonic indo tipo "oii pessoa :D"',
					"aqui, neste cantinho da internet",
					"você pode encontrar coisas que eu faço, e coisas que eu escrevo",
					"mas eu ainda to trabalhando nele (as vezes) :P",
					"e se certifique de ver as outras páginas!!",
					"se você quiser, pelo menos",
					"CUIDADO DISPOSITIVOS MÓVEIS!!",
					"o site pode acabar te mordeno D:",
					"pelo menos foi o que me falaram!",
					'aé, aqui está o meu <a href="https://pacola.atabook.org/" target="_blank" rel="noopener noreferrer">guestbook</a>!!'
				],
			},

			"statuscafe": {
				"title": "trequinho do status cafe"
			},

			"characterWindow": {
				"title": "meu personagem",
				"content": [
					"insira personagem aqui :)"
				]
			},

			"pacThing": {
				"title": "coisa da pac do tempo",
				"content": [
					"sonic blast é um jogo",
          "legal, em minha opinião"
				]
			}
		},

		"aboutme": {
			"mainWindow": {
				"title": "sobre mim :D",
				"content": [
					"eu sou a pacola, mas tu pode me chamar só de pac também!",
          "eu vou por ela/dela (transfem!), gosto de sonic, programação, eu acho",
          "não sei muito o que dizer sobre mim, pra falar a verdade",
          "o que eu faço da minha vida?",
          "nada!! ...que é muito útil",
          "tirando isso, eu já:",
          "... já mencionei que eu gosto de sonic???"
				]
			},
			"aboutmeList": {
				"content": [
					"fiz alguns modzinhos estúpidos de srb2, tu podés encontrár algum deles na página de projetos!",
					'consegui dois 2 récordes mundiais de <a href="https://www.speedrun.com/sonicblast" target="_blank" rel="noopener noreferrer">Sonic Blast</a> (ambas categorias de sonic!), no qual eu estou muito orgulhosa :D',
					"um pouco de arte, nada chique",
					"um pouco de código, as vezes, nunca disse que era bom",
					"procastinei um monte"
				]
			}
		},

		"projects": {
			"glassMain2TheSequel": {
				"title": "os projetos (do srb2)",
				"content": [
					'alguns outros mods podem ser encontrados no meu <a href="https://github.com/PacolaYes" target="_blank" rel="noopener noreferrer">github</a> também, mas eles podem estar ou abandonados ou só inacabados :P'
				]
			},

			"blastHUDIMG": {
				"content": [
					"gif demonstrando o title card do Sonic Blast no SRB2"
				]
			},
			"blastHUDContent": {
				"content": [
					"<h2>Sonic Blast HUD</h2>",
					"Um mod de aparência simples, substitui o hud do SRB2 com aquele visto em Sonic Blast."
				]
			},

			"sunkyIMG": {
				"content": [
					"gif demonstrando o Sunky caindo de uma platafoma na Greenflower Zone act 1"
				]
			},
			"sunkyContent": {
				"content": [
					"<h2>Sunky</h2>",
					"adiciona o Sunky, versão atual é pra ser o mais perto que eu consegui do Sunky the Game, talvez ganhe uma atualização um dia, ou então eu espero!"
				]
			},

			"smwLuigiIMG": {
				"content": [
					"gif demonstrando o SMW Luigi fazendo dando pirueta, correndo e dislizano"
				]
			},
			"smwLuigiContent": {
				"content": [
					"<h2>SMW Luigi</h2>",
					"tenta adicionar o Luigi e algumas outras coisas do Super Mario World.",
          "Ainda sendo feito, as vezes. Mas você pode pegar algumas builds, as vezes também."
				]
			}
		},

		"blog-home": {
			"mainWindow": {
				"title": "blogs!!",
				"content": [
					"aqui é onde eu faço as coisas de \"blog\"",
          "não tenho certeza se é mesmo um blog, eu chamaria ele algo como:",
          '"lugar onde eu posso ou não as vezes escrever algo mas na maioria das vezes vai provavelmente ser um talvez não já que eu provavelmente não irei escrevê-lo mas pode talvez acontecer ou não"',
          "não tenho certeza do que mais escrever aqui, veja o treco da direita pros blogs",
          "se tiver algum :P"
				]
			},
			"blogList": {
				"title": "blogs listados"
			}
		},

		"global": {
			"thelinknames": [
				"página principal!",
				"sobre mim!",
				"meus projetos",
				"treco do blog"
			]
		}
	}
}

// the "we dont want these >:(" tags
excludeTags = [
	"BR", "UL",
	"OL", "DIV"
]

function loopThroughObjRecurs(obj, propExec) { // modified from https://stackoverflow.com/questions/2549320/looping-through-an-object-tree-recursively
  for (var k in obj) {
		retVal = propExec(k, obj[k])

    if (typeof obj[k] === 'object' && obj[k] !== null && obj[k].children != null && retVal != true) {
      loopThroughObjRecurs(obj[k].children, propExec)
    }
  }
}

function getLocalStorageItem(item, defaultval=null) {
  let founditem = window.localStorage.getItem(item)
  
  if (!founditem && defaultval != null) {
    window.localStorage.setItem(item, defaultval)
    return
  }
  return founditem || defaultval
}

function setLanguage(lang) {
	if (!languages[lang]) {
		return
	}

	let fileName = location.href.split("/").slice(-1)[0] || "index"; // base page prob means its index in neocities :P
	let langFile = fileName.split(".")[0];
	let curLang = languages[lang][langFile]

	loopThroughObjRecurs(document.body.children, function(_, child) {
		let id = child.id

		if (!((curLang && curLang[id]) || languages[lang]["global"][id])) {
			return
		}
		let langElement = (curLang[id] || languages[lang]["global"][id])

		let titleElement = child.getElementsByClassName("glassTitle")[0]
		let mainElement = child.getElementsByClassName("mainWindowContent")[0] || child
		if (titleElement != null && langElement.title != null) {
			titleElement.innerHTML = langElement.title
		}

		if (mainElement != null && langElement.content) {
			let langIndex = 0
			for (i = 0; i < mainElement.children.length; i++) {
				let element = mainElement.children[i]
				let supposedLang = langElement.content[langIndex]

				if (!supposedLang || excludeTags.includes(element.nodeName)) {
					continue
				}

				if (element.nodeName == "IMG") {
					element.alt = supposedLang
				} else {
					element.innerHTML = supposedLang
				}
				langIndex++
			}
		}

		//return true
	})
	window.localStorage.setItem("savedLang", lang)
}

function loadSavedLanguage() {
	setLanguage(
		getLocalStorageItem("savedLang", "english")
	)
}

function switchLang() { // switch between english and portuguese, since thats the only languages :þ
	let savedLang = getLocalStorageItem("savedLang", "english")
	if (savedLang == "english") {
		setLanguage("portuguese")
	} else {
		setLanguage("english")
	}

	document.getElementById("coolLinks").innerHTML = ""
	addLinks()
}

document.addEventListener("DOMContentLoaded", loadSavedLanguage, false);